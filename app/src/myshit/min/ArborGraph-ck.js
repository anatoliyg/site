define(function(t,e,a){function l(t){this.defaultSize=t,n.apply(this,arguments),this.setSize(this.defaultSize);var e=this;setTimeout(function(){e.init()},1e3)}var r=t("arbor/arbor"),n=t("famous/surfaces/CanvasSurface"),i=t("famous/modifiers/StateModifier"),o=t("famous/core/View");l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.prototype.init=function(){function t(){f=1,d=f-1,p=8,g=70,m=255,y=140,R="rgba("+g+","+m+","+y+",",M=1,u=o.width,c=o.height,V=320,k=u/2,X=c/2,Y=V-2,v={},x={},T=.1,A=.5,C=.1,O=-0,Z=2.5,S=0,P=0,I=-3-n,w=-750,z=2*Math.PI/500,b=0,h=setInterval(e,.1)}function e(){if(d++,d>=f)for(d=0,K=0;p>K;K++){L=2*Math.random()*Math.PI,N=Math.acos(2*Math.random()-1),Q=n*Math.sin(N)*Math.cos(L),U=n*Math.sin(N)*Math.sin(L),W=n*Math.cos(N);var t=a(Q,P+U,I+W,.002*Q,.002*U,.002*W);t.attack=50,t.hold=50,t.decay=100,t.initValue=0,t.holdValue=M,t.lastValue=0,t.stuckTime=90+20*Math.random(),t.accelX=0,t.accelY=O,t.accelZ=0}for(b=(b+z)%(2*Math.PI),E=Math.sin(b),F=Math.cos(b),s.fillStyle="#000000",s.fillRect(0,0,u,c),t=v.first;null!=t;)D=t.next,t.age++,t.age>t.stuckTime&&(t.velX+=t.accelX+T*(2*Math.random()-1),t.velY+=t.accelY+A*(2*Math.random()-1),t.velZ+=t.accelZ+C*(2*Math.random()-1),t.x+=t.velX,t.y+=t.velY,t.z+=t.velZ),G=F*t.x+E*(t.z-I),H=-E*t.x+F*(t.z-I)+I,j=i*V/(V-H),t.projX=G*j+k,t.projY=t.y*j+X,t.age<t.attack+t.hold+t.decay?t.age<t.attack?t.alpha=(t.holdValue-t.initValue)/t.attack*t.age+t.initValue:t.age<t.attack+t.hold?t.alpha=t.holdValue:t.age<t.attack+t.hold+t.decay&&(t.alpha=(t.lastValue-t.holdValue)/t.decay*(t.age-t.attack-t.hold)+t.holdValue):t.dead=!0,B=t.projX>u||t.projX<0||t.projY<0||t.projY>c||H>Y?!0:!1,B||t.dead?l(t):(J=1-H/w,J=J>1?1:0>J?0:J,s.fillStyle=R+J*t.alpha+")",s.beginPath(),s.arc(t.projX,t.projY,j*Z,0,2*Math.PI,!1),s.closePath(),s.fill()),t=D}function a(t,e,a,l,r,n){var i,o;return null!=x.first?(i=x.first,null!=i.next?(x.first=i.next,i.next.prev=null):x.first=null):i={},null==v.first?(v.first=i,i.prev=null,i.next=null):(i.next=v.first,v.first.prev=i,v.first=i,i.prev=null),i.x=t,i.y=e,i.z=a,i.velX=l,i.velY=r,i.velZ=n,i.age=0,i.dead=!1,i.right=Math.random()<.5?!0:!1,i}function l(t){v.first==t?null!=t.next?(t.next.prev=null,v.first=t.next):v.first=null:null==t.next?t.prev.next=null:(t.prev.next=t.next,t.next.prev=t.prev),null==x.first?(x.first=t,t.prev=null,t.next=null):(t.next=x.first,x.first.prev=t,x.first=t,t.prev=null)}var r=this,n=280,i=1,o=$("canvas.famous-surface")[0],s=this.getContext("2d");o.setAttribute("width","900"),o.setAttribute("height","520");var u,c,h,f,d,p,v,x,M,g,m,y,V,j,k,X,Y,b,z,S,P,I,Z,w,T,A,C,O,R,q,B,D,E,F,G,H,J,K,L,N,Q,U,W;t()},a.exports=l});